<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>配对 - OpenClaw 文档</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="nav-logo">
                <span class="logo-icon">🦞</span>
                <span class="logo-text">OpenClaw 中文文档</span>
            </a>
            <button class="nav-toggle" onclick="toggleNav()">☰</button>
            <div class="nav-links" id="navLinks">
                <div class="nav-section">
                    <span class="nav-section-title">入门指南</span>
                    <a href="../start/getting-started.html">快速入门</a>
                    <a href="../start/wizard.html">向导</a>
                    <a href="../start/pairing.html">配对</a>
                    <a href="../start/setup.html">设置</a>
                    <a href="../start/openclaw.html">OpenClaw 助手</a>
                    <a href="../start/hubs.html">文档中心</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">网关配置</span>
                    <a href="../gateway/configuration.html">配置</a>
                    <a href="../gateway/configuration-examples.html">配置示例</a>
                    <a href="../gateway/security.html">安全</a>
                    <a href="../gateway/remote.html">远程访问</a>
                    <a href="../gateway/tailscale.html">Tailscale</a>
                    <a href="../gateway/multiple-gateways.html">多网关</a>
                    <a href="../gateway/discovery.html">发现机制</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">消息渠道</span>
                    <a href="../channels/whatsapp.html">WhatsApp</a>
                    <a href="../channels/telegram.html">Telegram</a>
                    <a href="../channels/discord.html">Discord</a>
                    <a href="../channels/mattermost.html">Mattermost</a>
                    <a href="../channels/imessage.html">iMessage</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">Web 界面</span>
                    <a href="../web/webchat.html">WebChat</a>
                    <a href="../web/control-ui.html">控制界面</a>
                    <a href="../web/dashboard.html">控制台</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">核心概念</span>
                    <a href="../concepts/streaming.html">流式传输</a>
                    <a href="../concepts/groups.html">群组</a>
                    <a href="../concepts/group-messages.html">群组消息</a>
                    <a href="../concepts/multi-agent.html">多代理路由</a>
                    <a href="../concepts/session.html">会话</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">自动化</span>
                    <a href="../automation/cron-jobs.html">定时任务</a>
                    <a href="../automation/webhook.html">Webhooks</a>
                    <a href="../automation/gmail-pubsub.html">Gmail Pub/Sub</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">工具与技能</span>
                    <a href="../tools/slash-commands.html">斜杠命令</a>
                    <a href="../tools/skills.html">技能</a>
                    <a href="../tools/skills-config.html">技能配置</a>
                    <a href="../tools/web.html">Web 工具</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">安装与平台</span>
                    <a href="../install/updating.html">更新</a>
                    <a href="../install/nix.html">Nix 模式</a>
                    <a href="../platforms/macos.html">macOS</a>
                    <a href="../platforms/ios.html">iOS</a>
                    <a href="../platforms/android.html">Android</a>
                    <a href="../platforms/windows.html">Windows (WSL2)</a>
                    <a href="../platforms/linux.html">Linux</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">节点与媒体</span>
                    <a href="../nodes/index.html">节点</a>
                    <a href="../nodes/images.html">图片</a>
                    <a href="../nodes/audio.html">音频</a>
                </div>
                <div class="nav-section">
                    <span class="nav-section-title">其他</span>
                    <a href="../help.html">帮助</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="overlay" onclick="toggleNav()"></div>

    <main class="main-content">
        <div class="content">
            <h1>配对机制</h1>
            
            <p>"配对"是 OpenClaw 的<strong>显式所有者批准</strong>步骤。它在两个场景中使用：</p>
            <ol>
                <li><strong>DM 配对</strong>（谁可以与机器人对话）</li>
                <li><strong>节点配对</strong>（哪些设备/节点可以加入网关网络）</li>
            </ol>

            <p>安全上下文：<a href="../gateway/security.html">安全配置</a></p>

            <h2>1) DM 配对（入站聊天访问控制）</h2>
            
            <p>当频道配置为 DM 策略 <code>pairing</code> 时，未知发送者会收到一个短代码，其消息在获得批准前<strong>不会被处理</strong>。</p>

            <p>默认 DM 策略文档：<a href="../gateway/security.html">安全配置</a></p>

            <h3>配对代码</h3>
            <ul>
                <li>8 个字符，大写，不含易混淆字符（<code>0O1I</code>）</li>
                <li><strong>1 小时后过期</strong>。机器人仅在新请求创建时发送配对消息（大约每小时每个发送者一次）</li>
                <li>待处理的 DM 配对请求默认上限为<strong>每个频道 3 个</strong>；超过限制的请求将被忽略，直到有请求过期或被批准</li>
            </ul>

            <h3>批准发送者</h3>
            <pre><code>openclaw pairing list telegram
openclaw pairing approve telegram &lt;CODE&gt;</code></pre>

            <p>支持的频道：<code>telegram</code>、<code>whatsapp</code>、<code>signal</code>、<code>imessage</code>、<code>discord</code>、<code>slack</code></p>

            <h3>状态存储位置</h3>
            <p>存储在 <code>~/.openclaw/credentials/</code> 下：</p>
            <ul>
                <li>待处理请求：<code>&lt;channel&gt;-pairing.json</code></li>
                <li>已批准白名单存储：<code>&lt;channel&gt;-allowFrom.json</code></li>
            </ul>
            <p>将这些视为敏感文件（它们控制着对你助手的访问权限）。</p>

            <h2>2) 节点设备配对（iOS/Android/macOS/无头节点）</h2>
            
            <p>节点以 <code>role: node</code> 作为<strong>设备</strong>连接到网关。网关创建设备配对请求，必须经过批准。</p>

            <h3>批准节点设备</h3>
            <pre><code>openclaw devices list
openclaw devices approve &lt;requestId&gt;
openclaw devices reject &lt;requestId&gt;</code></pre>

            <h3>状态存储位置</h3>
            <p>存储在 <code>~/.openclaw/devices/</code> 下：</p>
            <ul>
                <li><code>pending.json</code>（短期；待处理请求会过期）</li>
                <li><code>paired.json</code>（已配对设备 + 令牌）</li>
            </ul>

            <h3>注意</h3>
            <ul>
                <li>遗留的 <code>node.pair.*</code> API（CLI：<code>openclaw nodes pending/approve</code>）是一个单独的网关拥有的配对存储。WS 节点仍需要设备配对。</li>
            </ul>

            <h2>相关文档</h2>
            <ul>
                <li>安全模型 + 提示注入：<a href="../gateway/security.html">安全配置</a></li>
                <li>安全更新（运行 doctor）：<a href="../install/updating.html">更新指南</a></li>
                <li>频道配置：
                    <ul>
                        <li>Telegram：<a href="../channels/telegram.html">Telegram</a></li>
                        <li>WhatsApp：<a href="../channels/whatsapp.html">WhatsApp</a></li>
                        <li>Signal：<a href="../channels/signal.html">Signal</a></li>
                        <li>iMessage：<a href="../channels/imessage.html">iMessage</a></li>
                        <li>Discord：<a href="../channels/discord.html">Discord</a></li>
                        <li>Slack：<a href="../channels/slack.html">Slack</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p>OpenClaw = CLAW + TARDIS — 因为每只太空龙虾都需要一台时空机器</p>
            <p>"我们都在玩自己的提示词。" — 某个 AI，大概 token 嗨了</p>
            <p class="license">MIT 协议 — 像海洋中的龙虾一样自由 🦞</p>
        </div>
    </footer>

    <script src="../assets/js/main.js"></script>
</body>
</html>
