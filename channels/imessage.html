<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iMessage - OpenClaw æ–‡æ¡£</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="nav-logo">
                <span class="logo-icon">ğŸ¦</span>
                <span class="logo-text">OpenClaw ä¸­æ–‡æ–‡æ¡£</span>
            </a>
            <button class="nav-toggle" onclick="toggleNav()">â˜°</button>
            <div class="nav-links" id="navLinks">

            <div class="nav-section">
                <span class="nav-section-title">å…¥é—¨æŒ‡å—</span>
                <a href="../start/getting-started.html">å¿«é€Ÿå…¥é—¨</a>
                <a href="../start/wizard.html">å‘å¯¼</a>
                <a href="../start/pairing.html">é…å¯¹</a>
                <a href="../start/setup.html">è®¾ç½®</a>
                <a href="../start/openclaw.html">OpenClaw åŠ©æ‰‹</a>
                <a href="../start/hubs.html">æ–‡æ¡£ä¸­å¿ƒ</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">ç½‘å…³é…ç½®</span>
                <a href="../gateway/configuration.html">é…ç½®</a>
                <a href="../gateway/configuration-examples.html">é…ç½®ç¤ºä¾‹</a>
                <a href="../gateway/security.html">å®‰å…¨</a>
                <a href="../gateway/remote.html">è¿œç¨‹è®¿é—®</a>
                <a href="../gateway/tailscale.html">Tailscale</a>
                <a href="../gateway/multiple-gateways.html">å¤šç½‘å…³</a>
                <a href="../gateway/discovery.html">å‘ç°æœºåˆ¶</a>
                <a href="../environment.html">ç¯å¢ƒå˜é‡</a>
                <a href="../logging.html">æ—¥å¿—é…ç½®</a>
                <a href="../network.html">ç½‘ç»œé…ç½®</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">æ¶ˆæ¯æ¸ é“</span>
                <a href="../channels/whatsapp.html">WhatsApp</a>
                <a href="../channels/telegram.html">Telegram</a>
                <a href="../channels/discord.html">Discord</a>
                <a href="../channels/mattermost.html">Mattermost</a>
                <a href="../channels/imessage.html">iMessage</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">Web ç•Œé¢</span>
                <a href="../web/webchat.html">WebChat</a>
                <a href="../web/control-ui.html">æ§åˆ¶ç•Œé¢</a>
                <a href="../web/dashboard.html">æ§åˆ¶å°</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">æ ¸å¿ƒæ¦‚å¿µ</span>
                <a href="../concepts/streaming.html">æµå¼ä¼ è¾“</a>
                <a href="../concepts/groups.html">ç¾¤ç»„</a>
                <a href="../concepts/group-messages.html">ç¾¤ç»„æ¶ˆæ¯</a>
                <a href="../concepts/multi-agent.html">å¤šä»£ç†è·¯ç”±</a>
                <a href="../concepts/session.html">ä¼šè¯</a>
                <a href="../broadcast-groups.html">å¹¿æ’­ç¾¤ç»„</a>
                <a href="../multi-agent-sandbox-tools.html">å¤šä»£ç†æ²™ç›’</a>
                <a href="../date-time.html">æ—¥æœŸæ—¶é—´</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">è‡ªåŠ¨åŒ–</span>
                <a href="../automation/cron-jobs.html">å®šæ—¶ä»»åŠ¡</a>
                <a href="../automation/webhook.html">Webhooks</a>
                <a href="../automation/gmail-pubsub.html">Gmail Pub/Sub</a>
                <a href="../hooks.html">é’©å­ç³»ç»Ÿ</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">å·¥å…·ä¸æŠ€èƒ½</span>
                <a href="../tools/slash-commands.html">æ–œæ å‘½ä»¤</a>
                <a href="../tools/skills.html">æŠ€èƒ½</a>
                <a href="../tools/skills-config.html">æŠ€èƒ½é…ç½®</a>
                <a href="../tools/web.html">Web å·¥å…·</a>
                <a href="../brave-search.html">Brave æœç´¢</a>
                <a href="../perplexity.html">Perplexity</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">å®‰è£…ä¸å¹³å°</span>
                <a href="../install/updating.html">æ›´æ–°</a>
                <a href="../install/nix.html">Nix æ¨¡å¼</a>
                <a href="../platforms/macos.html">macOS</a>
                <a href="../platforms/ios.html">iOS</a>
                <a href="../platforms/android.html">Android</a>
                <a href="../platforms/windows.html">Windows (WSL2)</a>
                <a href="../platforms/linux.html">Linux</a>
                <a href="../northflank.html">Northflank éƒ¨ç½²</a>
                <a href="../bedrock.html">AWS Bedrock</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">èŠ‚ç‚¹ä¸åª’ä½“</span>
                <a href="../nodes/index.html">èŠ‚ç‚¹</a>
                <a href="../nodes/images.html">å›¾ç‰‡</a>
                <a href="../nodes/audio.html">éŸ³é¢‘</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">CLI ä¸è°ƒè¯•</span>
                <a href="../cli/index.html">CLI å‚è€ƒ</a>
                <a href="../debug/node-issue.html">Node é—®é¢˜</a>
                <a href="../diagnostics/flags.html">è¯Šæ–­æ ‡å¿—</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">å®éªŒæ€§</span>
                <a href="../experiments/onboarding-config-protocol.html">é…ç½®åè®®</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">å…¶ä»–</span>
                <a href="../help.html">å¸®åŠ©</a>
            </div>

            </div>
        </div>
    </nav>

    <div class="overlay" onclick="toggleNav()"></div>

    <main class="main-content">
        <div class="content">
            <h1>iMessage</h1>
<h1>iMessageï¼ˆimsgï¼‰</h1>
<p>çŠ¶æ€ï¼šå¤–éƒ¨ CLI é›†æˆã€‚Gateway ç”Ÿæˆ <code>imsg rpc</code>ï¼ˆstdio ä¸Šçš„ JSON-RPCï¼‰ã€‚</p>
<h2>å¿«é€Ÿè®¾ç½®ï¼ˆåˆå­¦è€…ï¼‰</h2>
<ol>
<li>ç¡®ä¿ Messages åœ¨æ­¤ Mac ä¸Šç™»å½•ã€‚</li>
<li>å®‰è£… <code>imsg</code>ï¼š<ul>
<li><code>brew install steipete/tap/imsg</code></li>
</ul>
</li>
<li>ä½¿ç”¨ <code>channels.imessage.cliPath</code> å’Œ <code>channels.imessage.dbPath</code> é…ç½® OpenClawã€‚</li>
<li>å¯åŠ¨ Gateway å¹¶æ‰¹å‡†ä»»ä½• macOS æç¤ºï¼ˆè‡ªåŠ¨åŒ– + å®Œå…¨ç£ç›˜è®¿é—®ï¼‰ã€‚</li>
</ol>
<p>æœ€å°é…ç½®ï¼š</p>
<pre><code class="language-json5">{
  channels: {
    imessage: {
      enabled: true,
      cliPath: &quot;/usr/local/bin/imsg&quot;,
      dbPath: &quot;/Users/&lt;you&gt;/Library/Messages/chat.db&quot;
    }
  }
}
</code></pre>
<h2>å®ƒæ˜¯ä»€ä¹ˆ</h2>
<ul>
<li>ç”± macOS ä¸Šçš„ <code>imsg</code> æ”¯æŒçš„ iMessage é¢‘é“ã€‚</li>
<li>ç¡®å®šæ€§è·¯ç”±ï¼šå›å¤æ€»æ˜¯è¿”å›åˆ° iMessageã€‚</li>
<li>ç§èŠå…±äº« Agent çš„ä¸»ä¼šè¯ï¼›ç¾¤ç»„æ˜¯éš”ç¦»çš„ï¼ˆ<code>agent:&lt;agentId&gt;:imessage:group:&lt;chat_id&gt;</code>ï¼‰ã€‚</li>
<li>å¦‚æœå¤šå‚ä¸è€…çº¿ç¨‹ä»¥ <code>is_group=false</code> åˆ°è¾¾ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨ <code>channels.imessage.groups</code> é€šè¿‡ <code>chat_id</code> éš”ç¦»å®ƒï¼ˆå‚è§ä¸‹é¢çš„&quot;ç±»ç¾¤ç»„çº¿ç¨‹&quot;ï¼‰ã€‚</li>
</ul>
<h2>é…ç½®å†™å…¥</h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒiMessage å…è®¸å†™å…¥ç”± <code>/config set|unset</code> è§¦å‘çš„é…ç½®æ›´æ–°ï¼ˆéœ€è¦ <code>commands.config: true</code>ï¼‰ã€‚</p>
<p>ç¦ç”¨ï¼š</p>
<pre><code class="language-json5">{
  channels: { imessage: { configWrites: false } }
}
</code></pre>
<h2>è¦æ±‚</h2>
<ul>
<li>ç™»å½• Messages çš„ macOSã€‚</li>
<li>OpenClaw + <code>imsg</code> çš„å®Œå…¨ç£ç›˜è®¿é—®ï¼ˆMessages DB è®¿é—®ï¼‰ã€‚</li>
<li>å‘é€æ—¶çš„è‡ªåŠ¨åŒ–æƒé™ã€‚</li>
<li><code>channels.imessage.cliPath</code> å¯ä»¥æŒ‡å‘ä»»ä½•ä»£ç† stdin/stdout çš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªåŒ…è£…è„šæœ¬ï¼ŒSSH åˆ°å¦ä¸€å° Mac å¹¶è¿è¡Œ <code>imsg rpc</code>ï¼‰ã€‚</li>
</ul>
<h2>è®¾ç½®ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰</h2>
<ol>
<li>ç¡®ä¿ Messages åœ¨æ­¤ Mac ä¸Šç™»å½•ã€‚</li>
<li>é…ç½® iMessage å¹¶å¯åŠ¨ Gatewayã€‚</li>
</ol>
<h3>ä¸“ç”¨ Bot macOS ç”¨æˆ·ï¼ˆç”¨äºéš”ç¦»èº«ä»½ï¼‰</h3>
<p>å¦‚æœä½ å¸Œæœ› Bot ä»<strong>å•ç‹¬çš„ iMessage èº«ä»½</strong>å‘é€ï¼ˆå¹¶ä¿æŒä¸ªäºº Messages å¹²å‡€ï¼‰ï¼Œä½¿ç”¨ä¸“ç”¨ Apple ID + ä¸“ç”¨ macOS ç”¨æˆ·ã€‚</p>
<ol>
<li>åˆ›å»ºä¸“ç”¨ Apple IDï¼ˆä¾‹å¦‚ï¼š<code>my-cool-bot@icloud.com</code>ï¼‰ã€‚<ul>
<li>Apple å¯èƒ½è¦æ±‚ç”µè¯å·ç è¿›è¡ŒéªŒè¯ / 2FAã€‚</li>
</ul>
</li>
<li>åˆ›å»º macOS ç”¨æˆ·ï¼ˆä¾‹å¦‚ï¼š<code>openclawhome</code>ï¼‰å¹¶ç™»å½•ã€‚</li>
<li>åœ¨è¯¥ macOS ç”¨æˆ·ä¸­æ‰“å¼€ Messages å¹¶ä½¿ç”¨ Bot Apple ID ç™»å½• iMessageã€‚</li>
<li>å¯ç”¨è¿œç¨‹ç™»å½•ï¼ˆç³»ç»Ÿè®¾ç½® â†’ é€šç”¨ â†’ å…±äº« â†’ è¿œç¨‹ç™»å½•ï¼‰ã€‚</li>
<li>å®‰è£… <code>imsg</code>ï¼š<ul>
<li><code>brew install steipete/tap/imsg</code></li>
</ul>
</li>
<li>è®¾ç½® SSHï¼Œä½¿ <code>ssh &lt;bot-macos-user&gt;@localhost true</code> æ— éœ€å¯†ç å³å¯å·¥ä½œã€‚</li>
<li>å°† <code>channels.imessage.accounts.bot.cliPath</code> æŒ‡å‘è¿è¡Œ <code>imsg</code> ä½œä¸º Bot ç”¨æˆ·çš„ SSH åŒ…è£…å™¨ã€‚</li>
</ol>
<p>é¦–æ¬¡è¿è¡Œæ³¨æ„ï¼šå‘é€/æ¥æ”¶å¯èƒ½éœ€è¦ <em>Bot macOS ç”¨æˆ·</em> ä¸­çš„ GUI æ‰¹å‡†ï¼ˆè‡ªåŠ¨åŒ– + å®Œå…¨ç£ç›˜è®¿é—®ï¼‰ã€‚å¦‚æœ <code>imsg rpc</code> çœ‹èµ·æ¥å¡ä½æˆ–é€€å‡ºï¼Œç™»å½•åˆ°è¯¥ç”¨æˆ·ï¼ˆå±å¹•å…±äº«æœ‰å¸®åŠ©ï¼‰ï¼Œè¿è¡Œä¸€æ¬¡ <code>imsg chats --limit 1</code> / <code>imsg send ...</code>ï¼Œæ‰¹å‡†æç¤ºï¼Œç„¶åé‡è¯•ã€‚</p>
<p>ç¤ºä¾‹åŒ…è£…å™¨ï¼ˆ<code>chmod +x</code>ï¼‰ã€‚å°† <code>&lt;bot-macos-user&gt;</code> æ›¿æ¢ä¸ºä½ çš„å®é™… macOS ç”¨æˆ·åï¼š</p>
<pre><code class="language-bash">#!/usr/bin/env bash
set -euo pipefail

# é¦–å…ˆè¿è¡Œä¸€æ¬¡äº¤äº’å¼ SSH ä»¥æ¥å—ä¸»æœºå¯†é’¥ï¼š
#   ssh &lt;bot-macos-user&gt;@localhost true
exec /usr/bin/ssh -o BatchMode=yes -o ConnectTimeout=5 -T &lt;bot-macos-user&gt;@localhost \
  &quot;/usr/local/bin/imsg&quot; &quot;$@&quot;
</code></pre>
<p>ç¤ºä¾‹é…ç½®ï¼š</p>
<pre><code class="language-json5">{
  channels: {
    imessage: {
      enabled: true,
      accounts: {
        bot: {
          name: &quot;Bot&quot;,
          enabled: true,
          cliPath: &quot;/path/to/imsg-bot&quot;,
          dbPath: &quot;/Users/&lt;bot-macos-user&gt;/Library/Messages/chat.db&quot;
        }
      }
    }
  }
}
</code></pre>

        </div>
    </main>

    <script src="../assets/js/main.js"></script>
</body>
</html>
