<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>环境变量 - OpenClaw 文档</title>
    <link rel="stylesheet" href="assets/css/style.css?v=3">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <span class="logo-icon">🦞</span>
                <span class="logo-text">OpenClaw 中文文档</span>
            </a>
            <button class="nav-toggle" onclick="toggleNav()">☰</button>
            <div class="nav-links" id="navLinks">

            <div class="nav-section">
                <span class="nav-section-title">入门指南</span>
                <a href="start/getting-started.html">快速入门</a>
                <a href="start/wizard.html">向导</a>
                <a href="start/pairing.html">配对</a>
                <a href="start/setup.html">设置</a>
                <a href="start/openclaw.html">OpenClaw 助手</a>
                <a href="start/hubs.html">文档中心</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">网关配置</span>
                <a href="gateway/configuration.html">配置</a>
                <a href="gateway/configuration-examples.html">配置示例</a>
                <a href="gateway/security.html">安全</a>
                <a href="gateway/remote.html">远程访问</a>
                <a href="gateway/tailscale.html">Tailscale</a>
                <a href="gateway/multiple-gateways.html">多网关</a>
                <a href="gateway/discovery.html">发现机制</a>
                <a href="environment.html">环境变量</a>
                <a href="logging.html">日志配置</a>
                <a href="network.html">网络配置</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">消息渠道</span>
                <a href="channels/whatsapp.html">WhatsApp</a>
                <a href="channels/telegram.html">Telegram</a>
                <a href="channels/discord.html">Discord</a>
                <a href="channels/mattermost.html">Mattermost</a>
                <a href="channels/imessage.html">iMessage</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">Web 界面</span>
                <a href="web/webchat.html">WebChat</a>
                <a href="web/control-ui.html">控制界面</a>
                <a href="web/dashboard.html">控制台</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">核心概念</span>
                <a href="concepts/streaming.html">流式传输</a>
                <a href="concepts/groups.html">群组</a>
                <a href="concepts/group-messages.html">群组消息</a>
                <a href="concepts/multi-agent.html">多代理路由</a>
                <a href="concepts/session.html">会话</a>
                <a href="broadcast-groups.html">广播群组</a>
                <a href="multi-agent-sandbox-tools.html">多代理沙盒</a>
                <a href="date-time.html">日期时间</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">自动化</span>
                <a href="automation/cron-jobs.html">定时任务</a>
                <a href="automation/webhook.html">Webhooks</a>
                <a href="automation/gmail-pubsub.html">Gmail Pub/Sub</a>
                <a href="hooks.html">钩子系统</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">工具与技能</span>
                <a href="tools/slash-commands.html">斜杠命令</a>
                <a href="tools/skills.html">技能</a>
                <a href="tools/skills-config.html">技能配置</a>
                <a href="tools/web.html">Web 工具</a>
                <a href="brave-search.html">Brave 搜索</a>
                <a href="perplexity.html">Perplexity</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">安装与平台</span>
                <a href="install/updating.html">更新</a>
                <a href="install/nix.html">Nix 模式</a>
                <a href="platforms/macos.html">macOS</a>
                <a href="platforms/ios.html">iOS</a>
                <a href="platforms/android.html">Android</a>
                <a href="platforms/windows.html">Windows (WSL2)</a>
                <a href="platforms/linux.html">Linux</a>
                <a href="northflank.html">Northflank 部署</a>
                <a href="bedrock.html">AWS Bedrock</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">节点与媒体</span>
                <a href="nodes/index.html">节点</a>
                <a href="nodes/images.html">图片</a>
                <a href="nodes/audio.html">音频</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">CLI 与调试</span>
                <a href="cli/index.html">CLI 参考</a>
                <a href="debug/node-issue.html">Node 问题</a>
                <a href="diagnostics/flags.html">诊断标志</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">实验性</span>
                <a href="experiments/onboarding-config-protocol.html">配置协议</a>
            </div>
            <div class="nav-section">
                <span class="nav-section-title">其他</span>
                <a href="help.html">帮助</a>
            </div>

            </div>
        </div>
    </nav>

    <div class="overlay" onclick="toggleNav()"></div>

    <main class="main-content">
        <div class="content">
            <h1>环境变量</h1>
<h1>环境变量</h1>
<p>OpenClaw 从多个来源提取环境变量。规则是<strong>绝不覆盖现有值</strong>。</p>
<h2>优先级（从高到低）</h2>
<ol>
<li><strong>进程环境</strong>（Gateway 进程从父 shell/守护进程已经拥有的）</li>
<li><strong>当前工作目录中的 <code>.env</code></strong>（dotenv 默认；不覆盖）</li>
<li><strong><code>~/.openclaw/.env</code> 的全局 <code>.env</code></strong>（即 <code>$OPENCLAW_STATE_DIR/.env</code>；不覆盖）</li>
<li><strong><code>~/.openclaw/openclaw.json</code> 中的配置 <code>env</code> 块</strong>（仅在缺失时应用）</li>
<li><strong>可选的登录 shell 导入</strong>（<code>env.shellEnv.enabled</code> 或 <code>OPENCLAW_LOAD_SHELL_ENV=1</code>），仅对缺失的预期键应用</li>
</ol>
<p>如果配置文件完全缺失，跳过第 4 步；如果启用，shell 导入仍会运行。</p>
<h2>配置 <code>env</code> 块</h2>
<p>两种等效的方式设置内联环境变量（都是不覆盖的）：</p>
<pre><code class="language-json5">{
  env: {
    OPENROUTER_API_KEY: &quot;sk-or-...&quot;,
    vars: {
      GROQ_API_KEY: &quot;gsk-...&quot;
    }
  }
}
</code></pre>
<h2>Shell 环境导入</h2>
<p><code>env.shellEnv</code> 运行你的登录 shell 并仅导入<strong>缺失</strong>的预期键：</p>
<pre><code class="language-json5">{
  env: {
    shellEnv: {
      enabled: true,
      timeoutMs: 15000
    }
  }
}
</code></pre>
<p>环境变量等效项：</p>
<ul>
<li><code>OPENCLAW_LOAD_SHELL_ENV=1</code></li>
<li><code>OPENCLAW_SHELL_ENV_TIMEOUT_MS=15000</code></li>
</ul>
<h2>配置中的环境变量替换</h2>
<p>你可以在配置字符串值中直接使用 <code>${VAR_NAME}</code> 语法引用环境变量：</p>
<pre><code class="language-json5">{
  models: {
    providers: {
      &quot;vercel-gateway&quot;: {
        apiKey: &quot;${VERCEL_GATEWAY_API_KEY}&quot;
      }
    }
  }
}
</code></pre>
<p>完整详情参见 <a href="/gateway/configuration#env-var-substitution-in-config">配置：配置中的环境变量替换</a>。</p>
<h2>相关文档</h2>
<ul>
<li><a href="/gateway/configuration">Gateway 配置</a></li>
<li><a href="/help/faq#env-vars-and-env-loading">FAQ：环境变量和 .env 加载</a></li>
<li><a href="/concepts/models">模型概览</a></li>
</ul>

        </div>
    </main>

    <script src="assets/js/main.js?v=3"></script>
</body>
</html>
