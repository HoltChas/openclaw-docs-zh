---
summary: "Cron 与心跳对比"
read_when:
  - 你想了解何时使用哪种调度机制
  - 你需要配置自动化任务
  - 你在选择心跳还是 cron
---

# Cron vs 心跳

本文档解释何时使用每种调度机制进行自动化任务。

## 概述

指南比较两种调度方法：**心跳**（在主会话中运行的定期感知检查）和 **cron 任务**（可以在隔离会话中运行的精确基于时间的调度）。

## 心跳

心跳以固定间隔（默认 30 分钟）在主会话中运行。它们适合：

- 将多个定期检查（收件箱、日历、通知）批量处理为一个轮次
- 需要对话历史的上下文感知决策
- "搭载现有周期"的低开销监控

**关键优势**：如果没有需要关注的内容，Agent 响应 `HEARTBEAT_OK`，不会发送消息。

**配置示例**使用 JSON5 格式，选项包括 `every`（间隔）、`target`（投递位置）和 `activeHours`（可选时间窗口）。

## Cron 任务

Cron 提供"精确计时"，支持"带时区的 5 字段 cron 表达式"。最适合：

- 需要精确调度的任务（例如，每天早上 9 点准时的报告）
- 不需要对话上下文的独立任务
- 使用 `--at` 标志的一次性提醒
- 需要不同模型或思考级别的任务

**CLI 选项包括**：`--name`、`--cron`、`--tz`、`--session`、`--message`、`--model`、`--deliver`、`--channel`、`--to`、`--system-event`、`--wake` 和 `--delete-after-run`。

## 会话类型

| 类型 | 会话 | 历史 | 上下文 |
|------|------|------|--------|
| 心跳 | 主会话 | 共享 | 完整 |
| Cron（主会话） | 主会话 | 共享 | 完整 |
| Cron（隔离） | `cron:<jobId>` | 每次运行刷新 | 无 |

## Lobster 集成

Lobster 处理"多步骤工具管道"，具有确定性执行和审批门。心跳/cron 决定任务*何时*运行；Lobster 定义*执行什么步骤*。

## 成本提示

- 保持 HEARTBEAT.md 小以减少 token 开销
- 将类似检查批量处理到心跳中，而不是多个 cron 任务
- 对常规任务使用带有更便宜模型的隔离 cron
